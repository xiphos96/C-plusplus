# 16.1 (ABC 010 D - 浮気予防)

16.2 節で解説した「辺連結度」に関する理解を問う練習問題です。

通常の最小カット問題では、2 頂点 s, t 間の連結度を求めますが、今回は 1 点 s と多点 v1, ..., vK との間の連結度を求める問題となっています。その場合は、多点 v1, ..., vK に対応するスーパー頂点 t を用意して、v1, ..., vK から頂点 t へと辺を張るのが有効です。具体的なアルゴリズムについては、次の記事に記しています。

[AtCoder ABC 010 D - 浮気予防](https://drken1215.hatenablog.com/entry/2021/08/04/155100)

　

# 16.2 (RUPC 2018 day3-F - 最短距離を伸ばすえびちゃん)

教育的な良問ですね。まず、頂点 s, t 間の最短経路として考えられるものはいろいろ考えられますが、そのいずれの経路にも含まれないような辺については、伸ばしても特に意味がないといえます。よって、最短経路に含まれる可能性のある辺のみで構成されるグラフを考えてみましょう。

このグラフ (各辺 e の容量を c[e] とします)  の最小カットが求める最小コストになります。具体的なアルゴリズムについては、次の記事に記しています。

[AOJ 2872 最短距離を伸ばすえびちゃん](https://drken1215.hatenablog.com/entry/2021/08/05/013400)

　

# 16.3 (JAG 模擬地区 2014 F - Reverse a Road II.)

さて、まず愚直な解法として思いつくのは「各辺を 1 本ずつ flip していって、その都度最大流を流す」という方法でしょう。しかしこれでは膨大な計算時間を要してしまいます。

このような問題では、まずは普通に最大流問題を解いてみることが有効です。そしてその結果を活用することで、解きたい問題も効率よく解決できないかを考えてみましょう。

さて、最大流を流し終えた段階では、**残余グラフ**上において、頂点 s から到達可能な頂点集合を S としましょう。これは「最大流値 = 最小カット値」という有名な最大流-最小カット定理を証明するときによくやる論法です。頂点 t は S には含まれません。

また逆に残余グラフ上において、頂点 t へと到達可能な頂点集合を T としましょう。このとき S にも T にも含まれない頂点が存在する可能性があることに注意しましょう。

このとき、残余グラフ上で始点が T 側にあって終点が S 側にあるような辺に注目しましょう。このような辺は

- もともと S から T へ向かう辺であったが s-t パスとして選ばれた結果、残余グラフ上で向きが反転した辺
- もともと T から S へ向かう辺であって、s-t パスとして選ばれなかった辺

に分かれます。このうちの後者については、 flip することで新たに s-t パスが生成され、辺連結度の増大に寄与することになります。その他の辺については、flip することで辺連結度が増大することはありません。

以上から、残余グラフ上で始点が T 側にあって終点が S 側にあるような辺のうち、s-t パスに使われていない辺の本数が答えとなりことがわかりました。

具体的なアルゴリズムについては、次の記事に記しています。

[AOJ 2594 Reverse a Road II](https://drken1215.hatenablog.com/entry/2021/08/05/173900)

　

# 16.4 (ICPC 国内予選 2009 E - カードゲーム)

典型的な二部マッチングの問題です。16.5 節で解説した解法で解くことができます。具体的なアルゴリズムについては、次の記事に記しています。

[AOJ 1163 カードゲーム](https://drken1215.hatenablog.com/entry/2021/08/05/175900)

　

# 16.5 (SoundHound Inc. Programming Contest 2018 C - 広告)

この問題は「二部グラフの最大安定集合問題」について知っていれば典型問題と言えます。まず最大安定集合問題とは、「頂点のなかから、どの 2 頂点も辺で結ばれていないようにいくつかの頂点を選ぶとき、その最大個数を求める」という問題です。

一般のグラフでは最大安定集合問題は NP-hard であり、多項式時間ではおそらく解けないと考えられています。しかしながら二部グラフであれば、最大安定集合問題は、二部マッチングに帰着して解けることが知られています。その詳細については、次の記事に記しています。

[二部グラフの最小点被覆、最大安定集合 (最大独立集合)、最小辺被覆を総整理！](https://qiita.com/drken/items/7f98315b56c95a6181a4)

さて、今回考えるグラフも実は二部グラフになっています。今回考えるグラフのようにグリッドの隣接関係からなるグラフをグリッドグラフといいます。グリッドグラフは、マスを「市松模様」に塗り分けることができます。そのことから、二部グラフであることが従います。

まとめると、今回の問題は「二部グラフの最大安定集合問題」へと帰着されましたので、二部マッチングアルゴリズムで解くことができます。具体的なアルゴリズムについては、次の記事に記しています。

[SoundHound 2018 予選 C - 広告](https://drken1215.hatenablog.com/entry/2019/06/17/221400)

　

# 16.6 (ARC 085 E - MUL)

16.7 節で解説した「プロジェクト選択問題」を活用する練習問題です。`x[i]` を、`a[i] = 0` とするときに 1、`a[i]` をそのままにするときに 0 とするような 0-1 変数としたとき、今回の問題の制約条件は

-----

j % i == 0 であるような組 (i, j) に対して、`x[i] = 1` であるにもかかわらず `x[j] = 0` である場合には INF (無限大) のペナルティがかかる

-----

というように解釈できます。これによって、プロジェクト選択問題の枠組みが適用できます。具体的なアルゴリズムについては、次の記事に記しています。

[AtCoder ARC 085 E - MUL](https://drken1215.hatenablog.com/entry/2019/12/17/113800)

　

# 16.7 (AOJ 2903 Board)

極めて難しい問題です。巧みに「プロジェクト選択問題」へと帰着します。具体的なアルゴリズムについては、次の記事に記しています。
[AOJ 2903 Board](https://drken1215.hatenablog.com/entry/2019/03/06/102100)

　



