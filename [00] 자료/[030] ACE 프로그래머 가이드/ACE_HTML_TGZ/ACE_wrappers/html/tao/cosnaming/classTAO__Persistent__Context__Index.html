<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>TAO_Persistent_Context_Index class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.13.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>TAO_Persistent_Context_Index  Class Reference</h1>This class facilitates implementation of Persistent Naming Service. It keeps track, centrally, of several pieces of info for each Persistent Naming Context, allowing to perform the initialization necessary for each Naming Context to restore the state of the Naming Service from persistent storage on server start-up. 
<a href="#_details">More...</a>
<p>
<code>#include &lt;Persistent_Context_Index.h&gt;</code>
<p>
Collaboration diagram for TAO_Persistent_Context_Index:<p><center><img src="classTAO__Persistent__Context__Index__coll__graph.gif" border="0" usemap="#TAO__Persistent__Context__Index__coll__map" alt="Collaboration graph"></center>
<map name="TAO__Persistent__Context__Index__coll__map">
<area doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Hash__Map__With__Allocator.html" shape="rect" coords="49,14,598,32" alt="">
<area doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator__Adapter.html" shape="rect" coords="25,82,622,100" alt="">
</map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center><a href="classTAO__Persistent__Context__Index-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Public Types</h2></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Hash__Map__With__Allocator.html">ACE_Hash_Map_With_Allocator</a>&lt;<br>
 <a class="el" href="classTAO__Persistent__Index__ExtId.html">TAO_Persistent_Index_ExtId</a>,<br>
 <a class="el" href="classTAO__Persistent__Index__IntId.html">TAO_Persistent_Index_IntId</a> &gt;&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#s0">CONTEXT_INDEX</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Hash map in which we will store info about each Persistent Naming Context.</em> <a href="#s0">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Hash__Map__With__Allocator.html">ACE_Hash_Map_With_Allocator</a>&lt;<br>
 <a class="el" href="classTAO__Persistent__ExtId.html">TAO_Persistent_ExtId</a>, <a class="el" href="classTAO__Persistent__IntId.html">TAO_Persistent_IntId</a> &gt;&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#s1">CONTEXT</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Hash map used by Persistent Naming Context to keep its state.</em> <a href="#s1">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator__Adapter.html">ACE_Allocator_Adapter</a>&lt;<br>
 <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Malloc.html">ACE_Malloc</a>&lt; <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/OS_8h.html#a63">ACE_MMAP_MEMORY_POOL</a>,<br>
 <a class="elRef" doxygen="TAO.tag:../" href="../orbconf_8h.html#a2">TAO_SYNCH_MUTEX</a> &gt; &gt;&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#s2">ALLOCATOR</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Allocator we will be using to make the Naming Service persistent.</em> <a href="#s2">More...</a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Public Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a0">TAO_Persistent_Context_Index</a> (<a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a91">CORBA::ORB_ptr</a> orb, PortableServer::POA_ptr poa)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Constructor.</em> <a href="#a0">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a1">open</a> (const <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/ace__wchar_8h.html#a9">ACE_TCHAR</a> *file_name, void *base_address=TAO_NAMING_BASE_ADDR)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a2">init</a> (size_t context_size)</td></tr>
<tr><td nowrap align=right valign=top>&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a3">~TAO_Persistent_Context_Index</a> (void)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a4">bind</a> (const char *poa_id, ACE_UINT32 *&amp;counter, <a class="el" href="classTAO__Persistent__Context__Index.html#s1">CONTEXT</a> *hash_map)</td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a5">unbind</a> (const char *poa_id)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Remove an entry for the Persistent Naming Context with &lt;poa_id&gt; from &lt;index_&gt; (i.e., this context has just been destroyed).</em> <a href="#a5">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator.html">ACE_Allocator</a> *&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a6">allocator</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Return allocator.</em> <a href="#a6">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a91">CORBA::ORB_ptr</a>&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a7">orb</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Return orb pointer.</em> <a href="#a7">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>CosNaming::NamingContext_ptr&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#a8">root_context</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Return a pointer to the root Naming Context (returns a copy - must be deallocated by the user).</em> <a href="#a8">More...</a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Private Methods</h2></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#c0">recreate_all</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Helper for the &lt;init&gt; method. Iterates over &lt;index_&gt;, and creates a servant for each entry.</em> <a href="#c0">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#c1">create_index</a> (void)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Helper for the &lt;open&gt; method.</em> <a href="#c1">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#c2">create_index_helper</a> (void *buffer)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Helper for &lt;create_index&gt; method: places hash table into an allocated space.</em> <a href="#c2">More...</a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="elRef" doxygen="TAO.tag:../" href="../orbconf_8h.html#a2">TAO_SYNCH_MUTEX</a>&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o0">lock_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Lock to prevent multiple threads from modifying entries in the &lt;index_&gt; simultanneously.</em> <a href="#o0">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="classTAO__Persistent__Context__Index.html#s2">ALLOCATOR</a> *&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o1">allocator_</a></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="classTAO__Persistent__Context__Index.html#s0">CONTEXT_INDEX</a> *&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o2">index_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Hash map where we keep entries for all Persistent Naming Contexts.</em> <a href="#o2">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>const <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/ace__wchar_8h.html#a9">ACE_TCHAR</a> *&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o3">index_file_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Name of the memory-mapped file used by &lt;allocator_&gt;.</em> <a href="#o3">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void *&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o4">base_address_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Base address for the memory-mapped file.</em> <a href="#o4">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a92">CORBA::ORB_var</a>&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o5">orb_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>ORB. We use it for several object_to_string conversions, and keep it around for Persistent Naming Contexts' use.</em> <a href="#o5">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>PortableServer::POA_var&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o6">poa_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>POA under which to register Persistent Naming Context servants during start-up.</em> <a href="#o6">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>CosNaming::NamingContext_var&nbsp;</td><td valign=bottom><a class="el" href="classTAO__Persistent__Context__Index.html#o7">root_context_</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>The reference to the root Naming Context.</em> <a href="#o7">More...</a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This class facilitates implementation of Persistent Naming Service. It keeps track, centrally, of several pieces of info for each Persistent Naming Context, allowing to perform the initialization necessary for each Naming Context to restore the state of the Naming Service from persistent storage on server start-up.
<p>

<p>
 This class creates a memory-mapped file, allocates a hash table from that file, and uses the hash table to store POA id, and table and counter pointers for each Persistent Naming Context. There are methods for adding and deleting entries from this hash table as new Persistent Naming Contexts are created and old ones are destroyed. This hash table facilitates Persistent Naming Context servant initialization upon Naming Server start-up. 
<p>
<hr><h2>Member Typedef Documentation</h2>
<a name="s2" doxytag="TAO_Persistent_Context_Index::ALLOCATOR"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator__Adapter.html">ACE_Allocator_Adapter</a>&lt;<a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Malloc.html">ACE_Malloc</a> &lt;<a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/OS_8h.html#a63">ACE_MMAP_MEMORY_POOL</a>, <a class="elRef" doxygen="TAO.tag:../" href="../orbconf_8h.html#a2">TAO_SYNCH_MUTEX</a>&gt; &gt; TAO_Persistent_Context_Index::ALLOCATOR
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocator we will be using to make the Naming Service persistent.
<p>
    </td>
  </tr>
</table>
<a name="s1" doxytag="TAO_Persistent_Context_Index::CONTEXT"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Hash__Map__With__Allocator.html">ACE_Hash_Map_With_Allocator</a>&lt;<a class="el" href="classTAO__Persistent__ExtId.html">TAO_Persistent_ExtId</a>, <a class="el" href="classTAO__Persistent__IntId.html">TAO_Persistent_IntId</a>&gt; TAO_Persistent_Context_Index::CONTEXT
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Hash map used by Persistent Naming Context to keep its state.
<p>
    </td>
  </tr>
</table>
<a name="s0" doxytag="TAO_Persistent_Context_Index::CONTEXT_INDEX"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Hash__Map__With__Allocator.html">ACE_Hash_Map_With_Allocator</a>&lt;<a class="el" href="classTAO__Persistent__Index__ExtId.html">TAO_Persistent_Index_ExtId</a>, <a class="el" href="classTAO__Persistent__Index__IntId.html">TAO_Persistent_Index_IntId</a>&gt; TAO_Persistent_Context_Index::CONTEXT_INDEX
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Hash map in which we will store info about each Persistent Naming Context.
<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="TAO_Persistent_Context_Index::TAO_Persistent_Context_Index"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TAO_Persistent_Context_Index::TAO_Persistent_Context_Index </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a91">CORBA::ORB_ptr</a>&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>orb</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>PortableServer::POA_ptr&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>poa</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor.
<p>
    </td>
  </tr>
</table>
<a name="a3" doxytag="TAO_Persistent_Context_Index::~TAO_Persistent_Context_Index"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TAO_Persistent_Context_Index::~TAO_Persistent_Context_Index </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. The memory mapped file that was opened/created is not deleted, since we want it to keep the state of the Naming Service until the next run.     </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a6" doxytag="TAO_Persistent_Context_Index::allocator"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator.html">ACE_Allocator</a> * TAO_Persistent_Context_Index::allocator </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return allocator.
<p>
    </td>
  </tr>
</table>
<a name="a4" doxytag="TAO_Persistent_Context_Index::bind"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::bind </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>poa_id</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>ACE_UINT32 *&amp;&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>counter</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classTAO__Persistent__Context__Index.html#s1">TAO_Persistent_Context_Index::CONTEXT</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>hash_map</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create an entry for a Persistent Naming Context in &lt;index_&gt;, i.e., a context with &lt;poa_id&gt;, &lt;counter&gt; and &lt;hash_map&gt; has just been created, and is registering with us.     </td>
  </tr>
</table>
<a name="c1" doxytag="TAO_Persistent_Context_Index::create_index"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::create_index </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper for the &lt;open&gt; method.
<p>
    </td>
  </tr>
</table>
<a name="c2" doxytag="TAO_Persistent_Context_Index::create_index_helper"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::create_index_helper </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>buffer</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper for &lt;create_index&gt; method: places hash table into an allocated space.
<p>
    </td>
  </tr>
</table>
<a name="a2" doxytag="TAO_Persistent_Context_Index::init"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::init </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">size_t&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>context_size</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
If &lt;index_&gt; contains no entries (i.e., was just created), create a root Persistent Naming Context servant with table of size &lt;context_size&gt;, and make an entry for it in the &lt;index_&gt;. If &lt;index_&gt; contains entries, create a Persistent Naming Context servant for each entry. Return 0 on success and -1 on failure.     </td>
  </tr>
</table>
<a name="a1" doxytag="TAO_Persistent_Context_Index::open"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::open </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/ace__wchar_8h.html#a9">ACE_TCHAR</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>file_name</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>base_address</em> = TAO_NAMING_BASE_ADDR</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/classACE__Allocator.html">ACE_Allocator</a>, open/create memory-mapped file with the specified file name/base address. Find or allocate &lt;index_&gt;. Return 0 on success or -1 on failure.     </td>
  </tr>
</table>
<a name="a7" doxytag="TAO_Persistent_Context_Index::orb"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a91">CORBA::ORB_ptr</a> TAO_Persistent_Context_Index::orb </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return orb pointer.
<p>
    </td>
  </tr>
</table>
<a name="c0" doxytag="TAO_Persistent_Context_Index::recreate_all"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::recreate_all </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper for the &lt;init&gt; method. Iterates over &lt;index_&gt;, and creates a servant for each entry.
<p>
    </td>
  </tr>
</table>
<a name="a8" doxytag="TAO_Persistent_Context_Index::root_context"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CosNaming::NamingContext_ptr TAO_Persistent_Context_Index::root_context </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp;          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return a pointer to the root Naming Context (returns a copy - must be deallocated by the user).
<p>
    </td>
  </tr>
</table>
<a name="a5" doxytag="TAO_Persistent_Context_Index::unbind"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int TAO_Persistent_Context_Index::unbind </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>poa_id</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Remove an entry for the Persistent Naming Context with &lt;poa_id&gt; from &lt;index_&gt; (i.e., this context has just been destroyed).
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a name="o1" doxytag="TAO_Persistent_Context_Index::allocator_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classTAO__Persistent__Context__Index.html#s2">ALLOCATOR</a>* TAO_Persistent_Context_Index::allocator_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocator that deals out memory from a memory-mapped file. We use it here, and in <a class="el" href="classTAO__Persistent__Naming__Context.html">TAO_Persistent_Naming_Context</a>, whenever we deal with data that should be kept in persistent store.     </td>
  </tr>
</table>
<a name="o4" doxytag="TAO_Persistent_Context_Index::base_address_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void* TAO_Persistent_Context_Index::base_address_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Base address for the memory-mapped file.
<p>
    </td>
  </tr>
</table>
<a name="o2" doxytag="TAO_Persistent_Context_Index::index_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classTAO__Persistent__Context__Index.html#s0">CONTEXT_INDEX</a>* TAO_Persistent_Context_Index::index_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Hash map where we keep entries for all Persistent Naming Contexts.
<p>
    </td>
  </tr>
</table>
<a name="o3" doxytag="TAO_Persistent_Context_Index::index_file_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const <a class="elRef" doxygen="ACE.tag:../../ace/" href="../../ace/ace__wchar_8h.html#a9">ACE_TCHAR</a>* TAO_Persistent_Context_Index::index_file_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Name of the memory-mapped file used by &lt;allocator_&gt;.
<p>
    </td>
  </tr>
</table>
<a name="o0" doxytag="TAO_Persistent_Context_Index::lock_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="elRef" doxygen="TAO.tag:../" href="../orbconf_8h.html#a2">TAO_SYNCH_MUTEX</a> TAO_Persistent_Context_Index::lock_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Lock to prevent multiple threads from modifying entries in the &lt;index_&gt; simultanneously.
<p>
    </td>
  </tr>
</table>
<a name="o5" doxytag="TAO_Persistent_Context_Index::orb_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="elRef" doxygen="TAO.tag:../" href="../namespaceCORBA.html#a92">CORBA::ORB_var</a> TAO_Persistent_Context_Index::orb_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
ORB. We use it for several object_to_string conversions, and keep it around for Persistent Naming Contexts' use.
<p>
    </td>
  </tr>
</table>
<a name="o6" doxytag="TAO_Persistent_Context_Index::poa_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PortableServer::POA_var TAO_Persistent_Context_Index::poa_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
POA under which to register Persistent Naming Context servants during start-up.
<p>
    </td>
  </tr>
</table>
<a name="o7" doxytag="TAO_Persistent_Context_Index::root_context_"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CosNaming::NamingContext_var TAO_Persistent_Context_Index::root_context_<code> [private]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The reference to the root Naming Context.
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Persistent__Context__Index_8h.html">Persistent_Context_Index.h</a><li><a class="el" href="Persistent__Context__Index_8cpp.html">Persistent_Context_Index.cpp</a></ul>
<hr><address><small>Generated on Thu Jan 16 00:34:18 2003 for TAO_CosNaming by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.13.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
